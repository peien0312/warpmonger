{% extends "public/base.html" %}

{% block title %}{{ post.title }} | Blog - Warpmonger{% endblock %}

{% block meta_description %}{{ post.content[:155] }}...{% endblock %}

{% block og_type %}article{% endblock %}
{% block og_title %}{{ post.title }}{% endblock %}
{% block og_description %}{{ post.content[:200] }}{% endblock %}

{% block structured_data %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "{{ post.title }}",
  "datePublished": "{{ post.date }}",
  {% if post.author %}
  "author": {
    "@type": "Person",
    "name": "{{ post.author }}"
  },
  {% endif %}
  "publisher": {
    "@type": "Organization",
    "name": "Warpmonger",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ request.url_root }}static/images/warpmonger_logo_black.png"
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ request.url }}"
  },
  "articleBody": "{{ post.content|replace('\n', ' ')|replace('"', '\\"') }}"
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org/",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Blog",
      "item": "{{ request.url_root }}blog"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "{{ post.title }}"
    }
  ]
}
</script>
{% endblock %}

{% block content %}
<div class="container">
    <article class="blog-post">
        <nav class="breadcrumb">
            <a href="{{ url_prefix }}/blog">{{ t.blog }}</a> / <span>{{ post.title }}</span>
        </nav>

        <header class="post-header">
            <h1>{{ post.title }}</h1>
            <p class="post-meta">
                {{ post.date }}
                {% if post.author %}by {{ post.author }}{% endif %}
            </p>
            {% if post.tags %}
            <div class="post-tags">
                {% for tag in post.tags %}
                <span class="tag">{{ tag }}</span>
                {% endfor %}
            </div>
            {% endif %}
        </header>

        <div class="post-content">
            {{ post.content_html|safe }}
        </div>

        <footer class="post-footer">
            <a href="{{ url_prefix }}/blog" class="btn btn-secondary">{{ t.back_to_blog }}</a>
        </footer>
    </article>
</div>
{% endblock %}
